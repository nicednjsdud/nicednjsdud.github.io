---
published: true
title: "🧩 시스템 간 비동기 연동 방식 정리 (메시징 / DB / CDC)"
layout: single
author_profile: true
read_time: true
comments: true
share: true
related: true
categories:
  - Backend
description: "분산 시스템의 비동기 연동 방식을 메시징 시스템, DB 폴링, CDC 기반으로 나누어 정리하고, 각 방식의 고려사항 및 트랜잭션 처리 전략(보상 트랜잭션)까지 함께 알아봅니다."
tag: "비동기 연동, Kafka, CDC, 시스템 연동"
article_tag1: "Architecture"
article_section: "시스템 통합"
meta_keywords: "비동기 연동, Kafka, CDC, 보상 트랜잭션, 이벤트 기반 아키텍처"
last_modified_at: "2025-05-21 15:45:00 +0800"
toc: true
toc_sticky: true
toc_label: "목차"
---


분산 시스템에서 비동기 연동을 활용하면,  
- 시스템 간 결합도를 낮추고  
- 호출 응답 대기를 줄이며  
- 트래픽 폭증 시에도 견고한 아키텍처를 구성할 수 있습니다.

아래 3가지 방식이 자주 사용됩니다:

1. 메시징 시스템 (Kafka, RabbitMQ 등)  
2. 데이터베이스 활용  
3. CDC (Change Data Capture)

---

## 1️⃣ 메시징 시스템 기반 연동

![alt](/assets/images/post/computer science/5.png)

### ✅ 개념
- A 시스템이 메시지를 **브로커(Kafka 등)** 에 보내고
- B 시스템이 이를 **구독**해서 처리하는 구조

### ✅ 장점
- 고성능, 고처리량
- 느슨한 결합
- 비동기 처리 가능

### ⚠️ 고려사항
- 메시지 유실 방지 → **ack 설정 / 재전송 설계 필요**
- 메시지 순서 보장 문제
- 트랜잭션 일관성 문제  
  (예: DB insert는 성공했는데 메시지는 실패)

### 💡 트랜잭션 고려
- DB insert + 메시지 전송을 원자적으로 처리할 수 없음 → **보상 트랜잭션 or Outbox 패턴** 고려

---

## 2️⃣ 데이터베이스 기반 연동

![alt](/assets/images/post/computer science/6.png)

### ✅ 개념
- A 시스템이 **DB의 메시지 테이블에 기록**
- B 시스템이 **주기적으로 테이블 조회(polling)** 후 메시지를 전송

### ✅ 장점
- DB 트랜잭션과 **원자성 보장**
- 메시지 유실 없음
- 순서 보장 가능

### ⚠️ 고려사항
- DB 스키마 변경에 영향 받음
- 읽기 주기 및 삭제 정책 필요
- 실시간성이 낮음 (폴링 주기 의존)

---

## 3️⃣ CDC(Change Data Capture) 기반 연동

![alt](/assets/images/post/computer science/7.png)

### ✅ 개념
- DB 변경 로그(binlog)를 감지하여
- 외부 시스템에 변경 내용을 **자동 전파**

### ✅ 장점
- 애플리케이션 코드 변경 최소화
- 트랜잭션 보장 (DB 기준)
- 복잡한 연동 로직 필요 없음

### ⚠️ 고려사항
- **변경 사유/의도**는 알 수 없음 (데이터만 감지)
- 실시간 처리는 가능하지만 지연 발생 가능
- 로그 기반 분석 툴 또는 CDC 플랫폼 필요 (Debezium 등)

---

## 💥 보상 트랜잭션이란?

> 분산 시스템에서는 하나의 트랜잭션으로 묶을 수 없기 때문에  
> “성공한 작업을 취소하는 작업”을 별도로 설계합니다.

### 예시 상황:
- 주문 생성 시스템 → 결제 시스템 호출 → 재고 시스템 호출
- 재고가 부족하면 결제 취소 필요  
→ 이때 결제 시스템에 **보상 작업(결제 취소)** 요청을 전송

### 보상 트랜잭션 특징
- 트랜잭션 실패 시 롤백이 아니라 **반대 작업 실행**
- **Saga 패턴**으로 구현 가능 (Local Saga, Choreography 방식 등)

---

## ✅ 총정리 비교표

| 방식 | 장점 | 단점 | 트랜잭션 처리 |
|------|------|------|----------------|
| 메시징 시스템 | 비동기, 확장성, 유연성 | 순서/유실/트랜잭션 고민 | 보상 트랜잭션 필요 |
| DB 기반 | 트랜잭션 보장, 유실 없음 | 실시간성 낮음 | DB 트랜잭션으로 처리 |
| CDC | 코드 최소화, 트랜잭션 보장 | 변경 사유 없음 | DB 트랜잭션 기반 |

---

## 📌 마무리

- 비동기 연동 방식은 **유연성, 성능, 확장성** 모두를 위한 필수 설계
- 어떤 방식이든 **일관성 보장과 실패 대응**이 핵심
- 메시징 기반은 **Outbox + 보상 트랜잭션**, CDC는 **데이터 추적 주의**


