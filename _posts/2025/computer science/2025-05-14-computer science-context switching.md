---
published: true
title: "🌀 컨텍스트 스위칭 완전 정복 - 프로세스와 스레드가 교체될 때 벌어지는 일들"
layout: single
author_profile: true
read_time: true
comments: true
share: true
related: true
categories:
  - Computer Science
description: "컨텍스트 스위칭은 OS와 CPU가 여러 작업을 동시에 처리하기 위해 필수적인 개념입니다. 프로세스/스레드 간 스위칭이 어떻게 동작하는지, 그리고 왜 스레드 스위칭이 더 빠른지까지 완전히 이해해 봅니다."
tag: "Context Switching, 스레드, 프로세스, 커널, MMU, TLB"
article_tag1: "운영체제 핵심 개념"
article_section: "시스템 성능"
meta_keywords: "Context Switching, 스레드 전환, 프로세스 교체, MMU, TLB 캐시"
last_modified_at: "2025-05-14 01:50:00 +0800"
toc: true
toc_sticky: true
toc_label: "목차"
---

## ✅ 컨텍스트 스위칭이란?

> **컨텍스트 스위칭(Context Switching)**이란 CPU가 **현재 실행 중인 작업을 멈추고**,  
> **다른 작업으로 전환**하기 위해 **상태 정보를 저장하고 복구**하는 과정입니다.

---

## 💡 왜 컨텍스트 스위칭이 필요할까?

운영체제는 **여러 작업(프로세스/스레드)**을 마치 동시에 처리하는 것처럼 보여야 합니다.  
하지만 CPU는 **한 번에 하나의 작업만 실행**할 수 있죠. 그래서 이렇게 처리합니다:

> 📌 일정 시간만큼 한 작업을 실행하고 → 다음 작업으로 교체  
> (= 컨텍스트 스위칭)

---

## 📦 컨텍스트란?

> "컨텍스트(Context)"는 현재 실행 중인 작업의 상태 정보입니다.

### 💾 포함되는 정보

- **CPU 레지스터 값** (프로그램 카운터, 스택 포인터 등)
- **메모리 정보** (프로세스의 주소 공간, 가상 주소 상태 등)
- **커널 내부 상태** (우선순위, 권한 등)

---

## 🔁 컨텍스트 스위칭이 발생하는 시점

| 시점 | 설명 |
|------|------|
| ⏱ 타임 슬라이스 종료 | 일정 시간 사용 후 교체 |
| 🧾 I/O 요청 | 디스크, 네트워크 요청 중 다른 작업으로 전환 |
| ⬆ 우선순위 작업 발생 | 더 중요한 작업이 생기면 선점 |

---

## 🧠 누가 이걸 처리할까?

컨텍스트 스위칭은 **운영체제의 커널(Kernel)** 이 수행합니다.  
커널이 다음 작업을 스케줄링하고, 필요한 상태 저장/복구를 모두 처리합니다.

---

## 🔍 프로세스 vs 스레드 컨텍스트 스위칭

| 항목 | 프로세스 | 스레드 |
|------|----------|--------|
| 속도 | 느림 ⏳ | 빠름 ⚡ |
| 메모리 영역 | 서로 다름 | 공유 |
| MMU 작업 | 필요함 | 불필요 |
| TLB 초기화 | 필요함 | 불필요 |
| 캐시 영향 | 크다 | 적다 |

---

### 🎯 왜 스레드 전환이 더 빠를까?

스레드는 **같은 프로세스 안에서 실행**되므로  
공통 메모리 영역을 **공유**합니다.  
따라서, **주소 공간 초기화가 필요 없습니다.**

---

## 🛠 프로세스 전환 시 추가로 벌어지는 일들

프로세스 전환은 단순히 CPU 상태만 바꾸는 게 아닙니다:

1. 현재 프로세스의 레지스터, 상태 저장  
2. 다음 프로세스의 상태 불러오기  
3. **MMU 설정 변경** → 메모리 주소 체계 바꿈  
4. **TLB 초기화** → 주소 매핑 캐시 제거

---

## 🔐 MMU, TLB가 뭐야?

### 📦 MMU (Memory Management Unit)

> 물리 메모리와 가상 주소를 연결하는 하드웨어 장치

- 프로세스마다 고유한 **가상 주소 공간**을 가짐
- MMU는 이 가상 주소를 물리 주소로 **매핑**해줌

### ⚡ TLB (Translation Lookaside Buffer)

> MMU가 자주 사용하는 주소 매핑을 저장하는 **캐시**

- 속도를 높이기 위해 주소 변환 정보를 **미리 저장**
- 하지만 프로세스를 바꾸면? → **캐시도 무효화 필요!**

---

## 🧪 예시로 쉽게 이해해 보기

### 🎮 게임(프로세스 A) → 📨 이메일 앱(프로세스 B)

- MMU는 게임의 주소 체계를 참조 중
- 이메일 앱으로 바꾸면 MMU 설정 변경
- 이전 게임의 주소 맵이 남아 있으면 위험 → TLB 초기화

### 🧵 스레드 간 전환은?

같은 프로세스 A 내에서  
- 네트워크 스레드 → 렌더링 스레드 전환 시  
- MMU/TLB 그대로! 단지 레지스터 정보만 바꾸면 됨

---

## 📌 한눈에 정리

| 구분 | 프로세스 스위칭 | 스레드 스위칭 |
|------|------------------|----------------|
| 메모리 주소 체계 | 다름 → MMU 재설정 | 같음 |
| TLB 초기화 | 필요함 | 필요 없음 |
| 속도 | 느림 | 빠름 |
| 커널 개입 | 필요 | 필요 |
| 캐시 영향 | TLB 캐시 제거 | 없음 |

---

## 🚀 결론

- 컨텍스트 스위칭은 **OS가 멀티태스킹을 지원하는 핵심 메커니즘**
- 스레드 간 전환은 빠르지만, 프로세스 간 전환은 상대적으로 무거움
- 고성능 시스템에서는 **스레드 기반 비동기 처리**가 더 유리할 수 있음

---
